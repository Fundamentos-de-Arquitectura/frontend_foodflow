<div  class="profile-header">
  <h1>{{ 'PROFILE_SETTINGS' | translate }}</h1>
</div>

<div class="profile-container">

  <div *ngIf="isLoading">
    <p>{{ 'LOADING_PROFILE' | translate }}</p>
  </div>

  <mat-card *ngIf="!isLoading && profile">
    <mat-card-header>
      <mat-icon mat-card-avatar>account_circle</mat-icon>
      <mat-card-title>{{ profile.fullName }}</mat-card-title>
      <mat-card-subtitle>{{ profile.email }}</mat-card-subtitle>
    </mat-card-header>

    <mat-divider></mat-divider>

    <mat-card-content>
      <div *ngIf="!isEditing">
        <!-- Display Mode -->
        <h3>{{ 'PERSONAL_INFORMATION' | translate }}</h3>
        <p><strong>{{ 'FULL_NAME' | translate }}:</strong> {{ profile.fullName }}</p>
        <p><strong>{{ 'EMAIL' | translate }}:</strong> {{ profile.email }}</p>
        <p><strong>{{ 'ADDRESS_FIELD' | translate }}:</strong> {{ profile.streetAddress }}</p>

        <mat-divider style="margin: 20px 0;"></mat-divider>

        <h3>{{ 'RESTAURANT_INFORMATION' | translate }}</h3>
        <p><strong>{{ 'RESTAURANT_NAME' | translate }}:</strong> {{ profile.restaurantName }}</p>
        <p><strong>{{ 'DESCRIPTION' | translate }}:</strong> {{ profile.restaurantDescription || ('NOT_PROVIDED' | translate) }}</p>
        <p><strong>{{ 'PHONE' | translate }}:</strong> {{ profile.restaurantPhone || ('NOT_PROVIDED' | translate) }}</p>
      </div>

      <div *ngIf="isEditing">
        <!-- Edit Mode -->
        <form [formGroup]="profileForm" (ngSubmit)="updateProfile()" class="profile-form">
          <h3>{{ 'PERSONAL_INFORMATION' | translate }}</h3>
          <mat-form-field appearance="outline">
            <mat-label>{{ 'FULL_NAME' | translate }}</mat-label>
            <input matInput formControlName="fullName" />
            <mat-error *ngIf="profileForm.get('fullName')?.hasError('required')">
              {{ 'FULL_NAME_REQUIRED' | translate }}
            </mat-error>
            <mat-error *ngIf="profileForm.get('fullName')?.hasError('minlength')">
              {{ 'FULL_NAME_MIN_LENGTH' | translate }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'EMAIL' | translate }}</mat-label>
            <input matInput formControlName="email" type="email" />
            <mat-error *ngIf="profileForm.get('email')?.hasError('required')">
              {{ 'EMAIL_REQUIRED' | translate }}
            </mat-error>
            <mat-error *ngIf="profileForm.get('email')?.hasError('email')">
              {{ 'EMAIL_INVALID' | translate }}
            </mat-error>
          </mat-form-field>

          <h3>{{ 'RESTAURANT_INFORMATION' | translate }}</h3>
          <mat-form-field appearance="outline">
            <mat-label>{{ 'RESTAURANT_NAME' | translate }}</mat-label>
            <input matInput formControlName="restaurantName" />
            <mat-error *ngIf="profileForm.get('restaurantName')?.hasError('required')">
              {{ 'RESTAURANT_NAME_REQUIRED' | translate }}
            </mat-error>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'RESTAURANT_DESCRIPTION' | translate }}</mat-label>
            <textarea matInput formControlName="restaurantDescription" rows="3"></textarea>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'RESTAURANT_PHONE' | translate }}</mat-label>
            <input matInput formControlName="restaurantPhone" />
          </mat-form-field>

          <h4>{{ 'CHANGE_PASSWORD' | translate }}</h4>
          <mat-form-field appearance="outline">
            <mat-label>{{ 'CURRENT_PASSWORD' | translate }}</mat-label>
            <input matInput formControlName="currentPassword" type="password" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'NEW_PASSWORD' | translate }}</mat-label>
            <input matInput formControlName="newPassword" type="password" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>{{ 'CONFIRM_NEW_PASSWORD' | translate }}</mat-label>
            <input matInput formControlName="confirmPassword" type="password" />
          </mat-form-field>
        </form>
      </div>
    </mat-card-content>

    <mat-card-actions>
      <div *ngIf="!isEditing">
        <button mat-raised-button color="primary" (click)="toggleEdit()">
          {{ 'EDIT' | translate }}
        </button>
      </div>

      <div *ngIf="isEditing">
        <button mat-button (click)="cancelEdit()">
          {{ 'CANCEL' | translate }}
        </button>
        <button mat-raised-button color="primary" (click)="updateProfile()">
          {{ 'SAVE_CHANGES' | translate }}
        </button>
      </div>
    </mat-card-actions>
  </mat-card>
</div>
